<div xmlns:th="http://www.thymeleaf.org" th:fragment="results" id="auditResults" class="space-y-4">
  <div class="overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-slate-200">
        <thead class="bg-slate-50">
          <tr>
            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-600">Timestamp</th>
            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-600">Actor</th>
            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-600">Action</th>
            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-600">Target</th>
            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-600">IP</th>
            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-600">Terminal</th>
            <th class="px-4 py-3 text-left text-xs font-semibold text-slate-600">Payload</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-100">
          <tr th:each="event : ${events}">
            <td class="px-4 py-3 text-xs text-slate-700" th:text="${#temporals.format(event.timestamp, 'yyyy-MM-dd HH:mm:ss')}">2026-01-01 10:00:00</td>
            <td class="px-4 py-3 text-xs text-slate-700">
              <div th:text="${event.actorUsername} ?: 'system'">admin</div>
              <div class="text-slate-500" th:text="${event.actorUserId} != null ? ('id=' + event.actorUserId) : '-'">id=1</div>
            </td>
            <td class="px-4 py-3 text-xs">
              <span class="rounded-full bg-slate-100 px-2 py-1 font-semibold text-slate-700" th:text="${event.actionType}">ACTION</span>
            </td>
            <td class="px-4 py-3 text-xs text-slate-700">
              <div th:text="${event.targetType}">SALE</div>
              <div class="text-slate-500" th:text="${event.targetId}">123</div>
            </td>
            <td class="px-4 py-3 text-xs text-slate-700" th:text="${event.ipAddress} ?: '-'">127.0.0.1</td>
            <td class="px-4 py-3 text-xs text-slate-700" th:text="${event.terminalId} ?: '-'">TERM-1</td>
            <td class="px-4 py-3 text-xs text-slate-600">
              <details>
                <summary class="cursor-pointer text-slate-700 hover:text-slate-900">View JSON</summary>
                <pre class="mt-2 max-w-xl overflow-x-auto rounded-lg bg-slate-900 p-2 text-[11px] leading-5 text-slate-100" th:text="'before: ' + ${event.beforeJson} + '\nafter: ' + ${event.afterJson} + '\nmetadata: ' + ${event.metadataJson}">payload</pre>
              </details>
            </td>
          </tr>
          <tr th:if="${#lists.isEmpty(events)}">
            <td colspan="7" class="px-4 py-8 text-center text-sm text-slate-500">No audit events found for the selected filters.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="flex items-center justify-between">
    <a th:if="${hasPrev}"
       th:href="@{__${basePath}__(page=${prevPage}, from=${from}, to=${to}, user=${user}, actionType=${actionType}, targetType=${targetType}, targetId=${targetId})}"
       th:attr="hx-get=@{__${basePath}__(page=${prevPage}, from=${from}, to=${to}, user=${user}, actionType=${actionType}, targetType=${targetType}, targetId=${targetId})}"
       hx-target="#auditResults"
       hx-swap="outerHTML"
       hx-push-url="true"
       class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition">
      Prev
    </a>
    <span th:unless="${hasPrev}" class="w-16"></span>
    <div class="text-xs text-slate-500">
      Page <span th:text="${page + 1}">1</span> / <span th:text="${totalPages}">1</span>
    </div>
    <a th:if="${hasNext}"
       th:href="@{__${basePath}__(page=${nextPage}, from=${from}, to=${to}, user=${user}, actionType=${actionType}, targetType=${targetType}, targetId=${targetId})}"
       th:attr="hx-get=@{__${basePath}__(page=${nextPage}, from=${from}, to=${to}, user=${user}, actionType=${actionType}, targetType=${targetType}, targetId=${targetId})}"
       hx-target="#auditResults"
       hx-swap="outerHTML"
       hx-push-url="true"
       class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 transition">
      Next
    </a>
    <span th:unless="${hasNext}" class="w-16"></span>
  </div>
</div>

spring.application.name=pos-system
spring.datasource.url=jdbc:mysql://localhost:3306/pos_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
spring.datasource.username=${DB_USERNAME:root}
spring.datasource.password=${DB_PASSWORD:123qweasdzxc}

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

spring.thymeleaf.cache=false

server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=always

# Multipart uploads
server.tomcat.max-part-count=200
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=12MB

# Currency settings
app.currency.base=USD
app.currency.base-name=US Dollar
app.currency.base-symbol=$
app.currency.base-decimals=2

app.currency.rate-url=https://open.er-api.com/v6/latest/{base}
app.currency.rate-path=rates

# Live FX endpoint that returns a JSON object with a "rates" map keyed by currency code.
# Free open endpoint (no key): https://open.er-api.com/v6/latest/{base}
# Note: Open endpoint updates once per day and is rate-limited.
app.currency.rate-url=https://open.er-api.com/v6/latest/{base}
app.currency.rate-path=rates
# Refresh cadence (ms). Adjust to respect provider limits (open endpoint recommends >=1 hour).
app.currency.refresh-ms=3600000
app.currency.refresh-initial-ms=5000

# Shift management
app.shift.variance-threshold=20.00

# Pagination / infinite feed
app.pagination.cursor-secret=${APP_PAGINATION_CURSOR_SECRET:change-me-in-prod}
app.pagination.feed.rate-limit-per-minute=240

# Auth
app.auth.sso.enabled=${APP_AUTH_SSO_ENABLED:true}
app.auth.sso.registration-id=${APP_AUTH_SSO_REGISTRATION_ID:corp}
app.auth.sso.auto-provision=${APP_AUTH_SSO_AUTO_PROVISION:true}
app.auth.sso.default-role=${APP_AUTH_SSO_DEFAULT_ROLE:CASHIER}
app.auth.sso.email-claim=${APP_AUTH_SSO_EMAIL_CLAIM:email}
app.auth.sso.username-claim=${APP_AUTH_SSO_USERNAME_CLAIM:preferred_username}
app.auth.sso.demo.enabled=${APP_AUTH_SSO_DEMO_ENABLED:true}
app.auth.sso.demo.client-id=${APP_AUTH_SSO_DEMO_CLIENT_ID:demo-client}
app.auth.sso.demo.client-secret=${APP_AUTH_SSO_DEMO_CLIENT_SECRET:demo-secret}
app.auth.sso.demo.user-sub=${APP_AUTH_SSO_DEMO_USER_SUB:demo-user-001}
app.auth.sso.demo.user-email=${APP_AUTH_SSO_DEMO_USER_EMAIL:demo.cashier@devcore.local}
app.auth.sso.demo.user-username=${APP_AUTH_SSO_DEMO_USER_USERNAME:demo.cashier}
app.auth.sso.demo.user-name=${APP_AUTH_SSO_DEMO_USER_NAME:Demo Cashier}

# SSO provider wiring. Defaults target the built-in local demo endpoints.
# Override SSO_* environment values to use an external identity provider.
spring.security.oauth2.client.registration.corp.client-id=${SSO_CLIENT_ID:${APP_AUTH_SSO_DEMO_CLIENT_ID:demo-client}}
spring.security.oauth2.client.registration.corp.client-secret=${SSO_CLIENT_SECRET:${APP_AUTH_SSO_DEMO_CLIENT_SECRET:demo-secret}}
spring.security.oauth2.client.registration.corp.scope=${SSO_SCOPES:profile,email}
spring.security.oauth2.client.registration.corp.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.corp.client-authentication-method=client_secret_post
spring.security.oauth2.client.registration.corp.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}
spring.security.oauth2.client.registration.corp.client-name=${SSO_CLIENT_NAME:Corporate SSO}
spring.security.oauth2.client.provider.corp.authorization-uri=${SSO_AUTHORIZATION_URI:http://localhost:${server.port:8080}/dev-sso/authorize}
spring.security.oauth2.client.provider.corp.token-uri=${SSO_TOKEN_URI:http://localhost:${server.port:8080}/dev-sso/token}
spring.security.oauth2.client.provider.corp.user-info-uri=${SSO_USERINFO_URI:http://localhost:${server.port:8080}/dev-sso/userinfo}
spring.security.oauth2.client.provider.corp.user-name-attribute=${SSO_USER_NAME_ATTRIBUTE:sub}

app.security.remember-me.key=${APP_SECURITY_REMEMBER_ME_KEY:change-me-in-prod}
app.security.login.max-failed-attempts=5
app.security.login.lock-duration-minutes=15
app.security.totp.node-command=node
app.security.totp.script-path=scripts/dev/speakeasy-totp.js
app.security.totp.issuer=DevCore POS
app.security.jwt.secret=${APP_SECURITY_JWT_SECRET:change-this-secret-key-with-at-least-32-bytes}
app.security.jwt.access-token-minutes=720
app.security.jwt.challenge-token-minutes=5
app.api.cors.allowed-origins=${APP_API_CORS_ALLOWED_ORIGINS:http://localhost:5173,http://localhost:3000}

# Flyway
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
